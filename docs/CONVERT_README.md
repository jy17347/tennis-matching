# 📊 Convert_Custom.py 사용 가이드

## 🎯 개요
`convert_custom.py`는 간단한 형식의 `custom.xlsx` 파일을 읽어서 `tennis_matching.py`가 생성하는 것과 **완전히 동일한 형식**의 결과물을 생성합니다.

## 📋 기능

### 입력
- `custom.xlsx`: 간단한 매칭 결과 (코트, 타임, 선수 4명)

### 출력
1. **엑셀 파일** (`results/테니스_매칭결과_YYYYMMDD_HHMMSS.xlsx`)
   - 매칭결과 시트
   - 타임표 시트
   - 참여통계 시트
   - 전체요약 시트

2. **PDF 파일** (`results/테니스_타임표_YYYYMMDD_HHMMSS.pdf`)
   - A4 가로 레이아웃
   - 타임표 (3코트 × 5타임)
   - 선수별 통계

## 🚀 사용법

### 기본 사용
```cmd
python convert_custom.py
```
- 프로젝트 루트의 `custom.xlsx` 파일을 읽어서 변환합니다.
- `results` 폴더에 엑셀과 PDF를 생성합니다.

### 다른 파일 지정
```cmd
python convert_custom.py --input "my_matches.xlsx"
```

### PDF 생성 제외
```cmd
python convert_custom.py --no-pdf
```

## 📂 입력 파일 형식 (custom.xlsx)

### 필수 시트: 매칭결과

| 코트 | 타임 | 팀1_선수1 | 팀1_선수2 | 팀2_선수1 | 팀2_선수2 |
|------|------|-----------|-----------|-----------|-----------|
| 1    | 1    | 정우용    | 이도훈    | 박창민    | 이영호    |
| 2    | 1    | 서지영    | 서윤식    | 김재혁    | 강경원    |
| 3    | 1    | 이희연    | 정혜린    | 정지윤    | 카밀라    |

**최소 필수 컬럼**: `코트`, `타임`, `팀1_선수1`, `팀1_선수2`, `팀2_선수1`, `팀2_선수2`

## 📤 출력 파일 형식

### 엑셀 파일 (4개 시트)

#### 1. 매칭결과 시트
```
코트 | 타임 | 경기타입 | 팀1_선수1 | 팀1_선수2 | 팀1_평균실력 | 팀2_선수1 | 팀2_선수2 | 팀2_평균실력 | 팀평균_실력차 | 상위선수_실력차 | 하위선수_실력차
```

#### 2. 타임표 시트
```
타임 | 코트1 | 코트2 | 코트3
-----|-------|-------|------
  1  | [남복] | [혼복] | [여복]
     | A & B | C & D | E & F
     |  vs   |  vs   |  vs
     | G & H | I & J | K & L
```

#### 3. 참여통계 시트
```
성명 | 성별 | 실력 | 참여횟수 | 남복 | 혼복 | 여복
```

#### 4. 전체요약 시트
```
항목                  | 값
---------------------|-----
총 경기 수           | 15
남복 경기 수         | 7
여복 경기 수         | 2
혼복 경기 수         | 6
총 참가자 수         | 13
평균 참여 횟수       | 4.62
평균 팀간 실력차     | 0.23
```

### PDF 파일
- **페이지 1**: 타임표 (컬러풀한 테이블)
- **페이지 2**: 선수별 참여 통계

## 🔧 자동 처리 기능

### 1. 경기 타입 자동 판단
- `dataset/roster.xlsx`에서 선수 성별 정보를 읽어옵니다.
- 4명이 모두 남자 → 남복
- 4명이 모두 여자 → 여복
- 남녀 혼합 → 혼복

### 2. 실력 정보 자동 계산
- `dataset/roster.xlsx`에서 선수 실력 정보를 읽어옵니다.
- 팀 평균 실력 = (선수1 실력 + 선수2 실력) / 2
- 팀 실력차 = |팀1 평균 - 팀2 평균|
- 상위/하위 선수 실력차 자동 계산

### 3. 참여 통계 자동 생성
- 각 선수의 총 참여 횟수
- 남복/여복/혼복 참여 횟수
- 실력차 평균

## 📝 실행 예시

### 예시 1: 기본 변환
```cmd
python convert_custom.py
```

**출력:**
```
============================================================
🎾 Custom.xlsx → Tennis Matching 형식 변환기
============================================================
📂 선수 정보 로드: dataset\roster.xlsx
✅ 24명 선수 정보 로드 완료
📂 참여 선수 로드: participation.xlsx
✅ 0명 참여 선수 확인

📂 매칭 데이터 로드: custom.xlsx
✅ 15개 경기, 13명 선수 파싱 완료

📝 엑셀 파일 생성 중...
✅ 엑셀 저장 완료: results\테니스_매칭결과_20260117_042922.xlsx

📄 PDF 생성 중...
✅ PDF 생성 완료: results\테니스_타임표_20260117_042922.pdf

============================================================
✅ 변환 완료!
   📊 엑셀: results\테니스_매칭결과_20260117_042922.xlsx
   📄 PDF: results\테니스_타임표_20260117_042922.pdf
============================================================
```

### 예시 2: 다른 파일 변환
```cmd
python convert_custom.py --input "my_schedule.xlsx"
```

## 🔗 관련 파일

### 필수 파일
- `custom.xlsx`: 변환할 매칭 결과 (간단한 형식)

### 선택 파일 (있으면 사용)
- `dataset/roster.xlsx`: 선수 정보 (성명, 성별, 실력, 번호)
- `participation.xlsx`: 참여 선수 목록

### 출력 폴더
- `results/`: 생성된 엑셀과 PDF 저장

## 💡 활용 방법

### 1. 수동 매칭 결과 검증
엑셀에서 직접 작성한 매칭을 `tennis_matching.py` 형식으로 변환하여:
- 경기 타입 자동 분류
- 실력 밸런스 확인
- 참여 통계 확인
- 인쇄용 PDF 생성

### 2. 외부 시스템 연동
다른 시스템에서 생성한 간단한 매칭 데이터를:
- 표준 형식으로 변환
- 통계 자동 생성
- PDF로 배포

### 3. 과거 데이터 변환
엑셀로 관리하던 과거 매칭 기록을:
- 표준 형식으로 통일
- 통계 분석
- 아카이브 관리

## ⚙️ 기술 스택

### 필수 라이브러리
- `pandas`: 엑셀 데이터 처리
- `openpyxl`: 엑셀 읽기/쓰기
- `reportlab`: PDF 생성
- `numpy`: 통계 계산

### 설치
```cmd
pip install pandas openpyxl reportlab numpy
```

## ❓ FAQ

### Q: custom.xlsx 형식이 다릅니다
A: 최소한 6개 컬럼(`코트`, `타임`, `팀1_선수1`, `팀1_선수2`, `팀2_선수1`, `팀2_선수2`)만 있으면 됩니다.

### Q: roster.xlsx가 없습니다
A: 선수 성별을 자동 추론할 수 없어 모두 남자로 처리됩니다. 가능하면 roster.xlsx를 준비하세요.

### Q: 생성된 파일 이름을 바꾸고 싶습니다
A: 타임스탬프가 자동으로 붙습니다. 생성 후 직접 이름을 변경하세요.

### Q: PDF에 한글이 깨집니다
A: Windows의 경우 자동으로 `malgun.ttf` 폰트를 사용합니다. 다른 OS는 한글 폰트 경로를 수정하세요.

### Q: tennis_matching.py 결과와 다릅니다
A: 입력 데이터가 같다면 출력 형식은 **완전히 동일**합니다. 컬럼 순서와 내용을 비교해보세요.

## 🔄 워크플로우

### 일반적인 사용 흐름
1. **준비**: `custom.xlsx` 파일에 매칭 결과 입력
2. **변환**: `python convert_custom.py` 실행
3. **확인**: `results` 폴더에서 생성된 엑셀과 PDF 확인
4. **배포**: PDF를 선수들에게 공유

### 기존 시스템과 통합
```python
# 다른 스크립트에서 호출
from convert_custom import CustomConverter

converter = CustomConverter('my_matches.xlsx')
converter.convert()
```

## 📞 참고

- `tennis_matching.py`: 매칭 알고리즘 (15경기 자동 생성)
- `visualization.py`: 결과 검증 및 시각화
- `convert_custom.py`: **간단한 입력 → 표준 출력 변환** ⭐

---
**Version**: 1.0  
**Last Updated**: 2026-01-17  
**Author**: Tennis Matching System
